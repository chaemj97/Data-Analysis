# 7-2. 머신러닝으로 예측하기

- 머신러닝
  - 컴퓨터 프로그램을 사용해 데이터에서 패턴을 학습하는 방법
  - 학습된 패턴을 사용하여 새로운 데이터에 대해 빠르고 유용한 결정을 내릴 수 있다.
  - 파이썬의 대표적인 머신러닝 패키지는 **사이킷런**



- 지도학습
  - 데이터에 있는 각 샘플에 대한 정답을 알고 있는 경우
    - 정답 == 타깃
    - 타깃을 맞추기 위해 모델이 재료로 사용하는 데이터 == 입력
  - 입력과 타깃이 들어있는 데이터를 사용해 어떤 머신러닝 모델을 훈련한 후, 타깃을 모르는 새로운 입력에 모델을 적용하여 타깃을 예측하는 것
- 비지도 학습
  - 입력 데이터는 있지만 타깃이 없는 경우
  - 정답 데이터를 모으기 매우 어렵거나 비용이 많이 드는 경우
  - ex) 대표적으로 군집 알고리즘
- 딥러닝
  - 신경망 알고리즘을 사용하는 경우
  - 머신러닝의 부분 집합
  - 지도학습이나 비지도학습에 모두 사용 가능



- 훈련 세트와 테스트 세트로 나누기

  - 보통 3:1 (75%:25%)

    - 비율 조정은 test_size 매개변수를 0~1 사이의 값으로 지정

    ```python
    train_set, test_set = train_test_split(df, random_state=42)
    ```



- 사이킷런은 입력으로는 2차원 배열, 타깃으로는 1차원 배열을 기대한다.

- 선형 회귀 모델

  ```python
  # 선형회귀모델
  from sklearn.linear_model import LinearRegression
  
  # 객체 생성
  lr = LinearRegression()
  # 모델 훈련
  lr.fit(X_train, y_train)
  ```



- 훈련 모델 평가

  - 객체.score(X,y)

    - 훈련된 머신러닝 모델이 얼마나 유용한지를 평가

    - 0~1 사이의 값 반환

      - 1에 가까울수록 X와 y의 관계가 깊다고 볼 수 있다.

      - 결정계수

        ![img](C:\Users\CHAE\OneDrive\바탕 화면\데이터 공부\Data-Analysis\혼자 공부하는 데이터 분석\img\07_2_사이킷런결정계수.JPG)

## 선형회귀

- 선형회귀는 선형 함수를 사용해 모델을 만드는 알고리즘

  - y = ax + b (x : 입력, y : 타깃, a : 기울기, b : 절편)

  - 선형회귀 알고리즘이 fit() 메서드를 호출했을 때 데이터에서 학습한 것이 기울기(a)와 절편(b)

    ```python
    print(lr.coef_, lr.intercept_)
    ```



## 카테고리 예측하기 : 로지스틱 회귀

- 타깃이 실수인 문제 : 회귀

- 타깃이 정수인 문제(연속적이지 않은 값) : 분류

  - 분류 알고리즘에서는 타깃 카테고리를 클래스라고 부른다

  - 이진 분류, 다중 분류

  - 대표적인 알고리즘 **로지스틱 회귀**

    - 선형 회귀처럼 선혀 함수를 사용하지만, 예측을 만들기 전에 로지스틱 함수를 거치는 과정이 있다.

      ![img](C:\Users\CHAE\OneDrive\바탕 화면\데이터 공부\Data-Analysis\혼자 공부하는 데이터 분석\img\07_2_로지스틱회귀.JPG)

      - 선형 함수의 결괏값 실수 z를 로지스틱 함수에 통과시키면 y는 0~1 사이의 값
      - 이때 y가 0.5보다 크면 양성 클래스로 예측하고 0.5보다 작으면 음성 클래스로 예측

    - 여러개의 클래스가 있는 다중 분류는 소프트맥스를 적용하거나 OvR(One versus Rest) 방식으로 여러 개의 이진 분류 모델을 만들어 다중 분류

    - 클래스 간의 비율이 균일하지 않으면 모델 성능을 자칫 잘못 해석할 수 있다.

  - 분류모델에서 score() 메서드

    - 정확도를 반환한다.

- 사이킷런은 상식적인 기준점을 설정하는 데 도움이 되도록 

  - 회귀일 경우 평균을 예측하는 DummyRegressor 클래스
  - 분류일 경우 다수 클래스를 예측하는 DummyClassifier 클래스를 제공



### 훈련된 모델을 평가할 수 있는 다른 측정 방법

- 평균제곱오차(mean squared error)
- 평균절댓값오차(mean absolute error)

- 예측
  - 사이킷런 모델의 predict() 메서드는 입력 데이터에 대한 예측을 만들어 준다
- 타깃과 예측의 평가
  - 사이킷런의 metrice 모듈 아래에서 mean_squared_error() 함수와 mean_absolute_error() 함수 사용